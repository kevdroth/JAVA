drop table if exists facturacion;

create table detalle_factura
(
    id                int not null auto_increment,
    id_linea          int    default null,
    id_factura        int not null,
    minutos           double default null,
    adicional_mensaje double default null,
    adicional_extra   double default null,
    roaming           double default null,
    seguro            double default null,
    iva               double default null,
    impuesto_interno  double default null,
    iibb_caba         double default null,
    iibb_gba          double default null,
    percepcion_iva    double default null,
    redondeo          double default null,
    total             double default null,
    constraint pk_detalle_factura primary key (id),
    constraint fk_id_linea foreign key (id) references lineas (id),
    constraint uc_detalle_factura unique (id_linea, id_factura),
    constraint fk_id_factura foreign key (id_factura) references factura (id)
);


insert into detalle_factura (id_linea, id_factura, minutos, adicional_mensaje, adicional_extra, roaming,
                             seguro, iibb_caba, iibb_gba, percepcion_iva, redondeo,
                             total)
values ((select id from lineas where numero = '1151615361'), (select id from factura where numero_factura = '637018'),
        1529, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1151653819'), (select id from factura where numero_factura = '637018'),
        395, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1151655430'), (select id from factura where numero_factura = '637018'),
        0, null, null, null, null, 12.19, null, null, null, 1033.26),
       ((select id from lineas where numero = '1151657653'), (select id from factura where numero_factura = '637018'),
        842, null, 192.06, null, null, 18.27, null, null, null, 1548.63),
       ((select id from lineas where numero = '1153276861'), (select id from factura where numero_factura = '637018'),
        131, null, null, null, null, 53.36, null, null, null, 4523.53),
       ((select id from lineas where numero = '1140472441'), (select id from factura where numero_factura = '637018'),
        13, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1150472566'), (select id from factura where numero_factura = '637018'),
        812, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1140472674'), (select id from factura where numero_factura = '637018'),
        225, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1150876318'), (select id from factura where numero_factura = '637018'),
        161, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1540428233'), (select id from factura where numero_factura = '637018'),
        0, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1540428253'), (select id from factura where numero_factura = '637018'),
        0, null, null, null, null, 12.19, null, null, null, 1033.26),
       ((select id from lineas where numero = '1540428338'), (select id from factura where numero_factura = '637018'),
        71, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1540428445'), (select id from factura where numero_factura = '637018'),
        27, null, null, null, null, 45.98, null, null, null, 3897.48),
       ((select id from lineas where numero = '1540428572'), (select id from factura where numero_factura = '637018'),
        0, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1540428586'), (select id from factura where numero_factura = '637018'),
        4, null, null, null, null, 15.24, null, null, null, 1291.58),
       ((select id from lineas where numero = '1541708803'), (select id from factura where numero_factura = '637018'),
        210, null, null, null, null, 15.24, null, null, null, 1291.58);